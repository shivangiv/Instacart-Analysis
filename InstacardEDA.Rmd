---
title: "InstacartEDA"
author: "Shivangi Vashi"
date: "5/26/2020"
output: html_document
---

Problem Statement
The Instacart data set is anonymized and contains samples of over 3 million grocery orders from 200,000+ Instacart users from Kaggle. The objective is to predict which previously purchased products (prior orders) will be in a user's next order (train and test orders) in order to explore the kinds of food Americans eat.

```{r}
library(dplyr)
library(tidyverse)
aisles<-read_csv(file.choose())
departments<-read_csv(file.choose())
order_products_prior<-read_csv(file.choose())
order_products_train<-read_csv(file.choose())
orders<-read_csv(file.choose())
products<-read_csv(file.choose())

aisles<-read_csv("/Users/shivangi/Documents/Analytics/Quarter 3/Data Mining/instacart-market-basket-analysis/aisles.csv")
departments<-read_csv("/Users/shivangi/Documents/Analytics/Quarter 3/Data Mining/instacart-market-basket-analysis/departments.csv")
order_products_prior<-read_csv("/Users/shivangi/Documents/Analytics/Quarter 3/Data Mining/instacart-market-basket-analysis/order_products__prior.csv")
order_products_train<-read_csv("/Users/shivangi/Documents/Analytics/Quarter 3/Data Mining/instacart-market-basket-analysis/order_products__train.csv")
orders<-read_csv("/Users/shivangi/Documents/Analytics/Quarter 3/Data Mining/instacart-market-basket-analysis/orders.csv")
products<-read_csv("/Users/shivangi/Documents/Analytics/Quarter 3/Data Mining/instacart-market-basket-analysis/products.csv")

```



#Create a new datafram named instacart by merging all datasets through inner join function, which only retains rows in all datasets.Here, we use order_products_prior dataframe includes only prior orders, so the new dataframe instacart will contain only these observations as well. 
```{r}
df<-list(aisles,departments,order_products_train,order_products_prior,orders,products)

instacart <- order_products_prior %>%
  inner_join(orders, by = c("order_id")) %>%
  inner_join(products, by = c("product_id")) %>%
  inner_join(aisles, by = c("aisle_id")) %>%
  inner_join(departments, by = c("department_id"))

summary(instacart)

```

### What did you do with the data in the context of exploration?

1. When do people order the most during the day? - shivangi
2. Frequency of reordering? - venus
3. Most popular products? - venus
4. Most popular department and most popular aisle? -rian

### What did you find? Why does that matter? 

### What would your proposed next steps be? 
- Apriori association rule algorithm
- classification- what are products are most likely to be reordered for each user?
- 


### Pre-processing
```{r}

# Taking a quick look at the data
head(aisles)
head(departments)
head(order_products_prior)
head(order_products_train)
head(orders)
head(products)

#Remove missing values
aisles<-drop_na(aisles)
departments<-drop_na(departments)
order_products_prior<-drop_na(order_products_prior)
order_products_train<-drop_na(order_products_train)
orders<-drop_na(orders)
products<-drop_na(products)

dim(aisles)
dim(departments)
dim(order_products_prior)
dim(order_products_train)
dim(orders)
dim(products)

# Check if all classes ie data types is correct
sapply(aisles,class)
sapply(departments,class)
sapply(order_products_prior,class)
sapply(order_products_train,class)
sapply(orders,class)
orders<-orders %>%mutate(order_hour_of_day=as.numeric(order_hour_of_day))
orders
sapply(products,class)



```

### 1. When do people order the most during the day?

```{r}

orders%>%
  group_by(order_hour_of_day)%>%
  summarise(Number_of_Orders=n())%>%
  ggplot(aes(y=Number_of_Orders, x=order_hour_of_day, fill=Number_of_Orders)) + geom_col()+ coord_cartesian(xlim = c(0, 24)) 

```
Clearly, most orders are placed during 9am to 5 pm.



